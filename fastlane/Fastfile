# Fastfile

default_platform(:ios)

platform :ios do
  desc "Authenticate with Apple Developer Portal"
  lane :authenticate do
    ENV["MATCH_GIT_BASIC_AUTHORIZATION"] = "Basic #{ENV['GITHUB_TOKEN']}"
    match(type: "development")
  end

  desc "Run SwiftLint"
  lane :lint do
    sh "swiftlint lint GimigoTheGecko"
  end

  desc "Build and test the app"
  lane :build_and_test do
    authenticate # Call the authenticate lane to ensure provisioning profiles are set up
    build_app(scheme: "GimigoTheGecko", export_method: "development")
    scan(scheme: "GimigoTheGecko", device: "iPhone 12")
  end
end

